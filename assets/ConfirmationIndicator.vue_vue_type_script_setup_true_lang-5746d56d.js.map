{"version":3,"file":"ConfirmationIndicator.vue_vue_type_script_setup_true_lang-5746d56d.js","sources":["../../src/components/web3/ConfirmationIndicator.vue"],"sourcesContent":["<script setup lang=\"ts\">\r\nimport { TransactionReceipt } from '@ethersproject/abstract-provider';\r\nimport { computed, reactive } from 'vue';\r\nimport { useQuery } from '@tanstack/vue-query';\r\n\r\nimport useConfig from '@/composables/useConfig';\r\nimport useEthers from '@/composables/useEthers';\r\nimport { dateTimeLabelFor } from '@/composables/useTime';\r\nimport QUERY_KEYS from '@/constants/queryKeys';\r\nimport useWeb3 from '@/services/web3/useWeb3';\r\n\r\ntype Props = {\r\n  txReceipt: TransactionReceipt;\r\n};\r\n\r\ntype ConfirmationData = {\r\n  confirmedAt: string;\r\n  explorerLink: string;\r\n};\r\n\r\nconst props = defineProps<Props>();\r\n\r\n/**\r\n * COMPOSABLES\r\n */\r\nconst { getTxConfirmedAt } = useEthers();\r\nconst { explorerLinks } = useWeb3();\r\nconst { networkConfig } = useConfig();\r\n\r\n/**\r\n * COMPUTED\r\n */\r\nconst isQueryEnabled = computed(() => !!receipt.value?.transactionHash);\r\n\r\nconst receipt = computed(() => props.txReceipt);\r\n\r\n/**\r\n * QUERIES\r\n */\r\nconst {\r\n  data: confirmationData,\r\n  isLoading: isFetchingConfirmationDate,\r\n  error,\r\n} = useQuery<ConfirmationData>(\r\n  QUERY_KEYS.Transaction.ConfirmationDate(receipt),\r\n  async () => {\r\n    const confirmedAt = await getTxConfirmedAt(receipt.value);\r\n    const explorerLink = explorerLinks.txLink(receipt.value.transactionHash);\r\n    return {\r\n      confirmedAt: dateTimeLabelFor(confirmedAt),\r\n      explorerLink,\r\n    };\r\n  },\r\n  reactive({ enabled: isQueryEnabled })\r\n);\r\n\r\nconst isLoading = computed(\r\n  (): boolean => isFetchingConfirmationDate.value || !!error.value\r\n);\r\n</script>\r\n\r\n<template>\r\n  <BalLoadingBlock v-if=\"isLoading\" class=\"h-6\" />\r\n  <div\r\n    v-else\r\n    class=\"flex justify-between items-center text-sm text-gray-400 dark:text-gray-600\"\r\n  >\r\n    <div class=\"flex items-center\">\r\n      <BalIcon name=\"clock\" />\r\n      <span class=\"ml-2\">\r\n        {{ confirmationData?.confirmedAt }}\r\n      </span>\r\n    </div>\r\n    <BalLink\r\n      :href=\"confirmationData?.explorerLink\"\r\n      external\r\n      noStyle\r\n      class=\"group flex items-center\"\r\n    >\r\n      {{ networkConfig.explorerName }}\r\n      <BalIcon\r\n        name=\"arrow-up-right\"\r\n        size=\"sm\"\r\n        class=\"ml-px group-hover:text-pink-500 transition-colors\"\r\n      />\r\n    </BalLink>\r\n  </div>\r\n</template>\r\n"],"names":["getTxConfirmedAt","useEthers","explorerLinks","useWeb3","networkConfig","useConfig","isQueryEnabled","computed","_a","receipt","props","confirmationData","isFetchingConfirmationDate","error","useQuery","QUERY_KEYS","confirmedAt","explorerLink","dateTimeLabelFor","reactive","isLoading"],"mappings":"geAyBA,CAAA,iBAAAA,GAAAC,IACA,CAAA,cAAAC,GAAAC,IACA,CAAA,cAAAC,GAAAC,IAKAC,EAAAC,EAAA,IAAA,OAAA,OAAA,GAAAC,EAAAC,EAAA,QAAA,MAAAD,EAAA,iBAAA,EAEAC,EAAAF,EAAA,IAAAG,EAAA,SAAA,EAKA,CAAM,KAAAC,EACE,UAAAC,EACK,MAAAC,CACX,EAAAC,EACEC,EAAA,YAAA,iBAAAN,CAAA,EAC6C,SAAA,CAE7C,MAAAO,EAAA,MAAAhB,EAAAS,EAAA,KAAA,EACAQ,EAAAf,EAAA,OAAAO,EAAA,MAAA,eAAA,EACA,MAAA,CAAO,YAAAS,EAAAF,CAAA,EACoC,aAAAC,CACzC,CACF,EACFE,EAAA,CAAA,QAAAb,EAAA,CACoC,EAGtCc,EAAAb,EAAkB,IAAAK,EAAA,OAAA,CAAA,CAAAC,EAAA,KAC2C"}