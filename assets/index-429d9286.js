var Oe=Object.defineProperty;var je=(s,e,t)=>e in s?Oe(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var Q=(s,e,t)=>(je(s,typeof e!="symbol"?e+"":e,t),t);import{d as q,c as g,h as Z,L as Qe,r as z,a as R,i as M,A as be,g as Re,u as H,b as ne,e as P,Q as se,f as ie,j as $e,l as te,k as Ue,m as He,n as U,w as le,o as O,p as V,q as oe,s as w,t as C,v as a,F as x,x as re,y as ue,z as L,B as b,C as T,D as c,E as We,P as he,G as D,H as h,I as ze,J as Ae,_ as ce,K as Ke,M as de,N as Ye,O as N,R as Me,S as Xe,T as Ze,U as G,V as Je,W as et,X as ae,Y as J,Z as we,$ as tt,a0 as ee,a1 as F,a2 as Te,a3 as at,a4 as nt,a5 as ve,a6 as st,a7 as it,a8 as lt,a9 as ot}from"./index-4a1c513c.js";import{_ as rt}from"./BalBlankSlate.vue_vue_type_style_index_0_lang-b4891eef.js";import{_ as ut}from"./BalLoadingBlock.vue_vue_type_style_index_0_lang-3fa460ee.js";import{H as ct}from"./HeroClaim-5fa237e0.js";import{_ as pe}from"./BalTable.vue_vue_type_style_index_0_lang-bfff8f7a.js";import{_ as dt}from"./BalAssetSet-1d81bc3d.js";import{_ as me}from"./TxActionBtn.vue_vue_type_script_setup_true_lang-2a66723f.js";import{_ as pt}from"./TokenPills.vue_vue_type_script_setup_true_lang-32c53459.js";import{_ as mt}from"./PoolWarningTooltip.vue_vue_type_script_setup_true_lang-c104e09b.js";import{_ as Le}from"./BalAsset-fe687731.js";import{u as yt}from"./useGraphQuery-caa1ada5.js";import{i as _e}from"./useQueryHelpers-8cb4e6d7.js";import{u as gt}from"./useTokenHelpers-ddc69531.js";import"./usePoolWarning-b134504b.js";const ft=q({name:"BalFlexGrid",props:{gap:{type:Number,default:4},flexWrap:{type:Boolean,default:!1}},setup(s,{slots:e}){const t=g(()=>(s.gap/2).toString()),n=g(()=>({"flex-wrap":s.flexWrap})),u=e.default()[0].children.map(d=>Z("div",{class:`px-${t.value} mb-${t.value}`},[d]));return()=>Z("div",{class:`px-${t.value}`},[Z("div",{class:[`flex -mx-${s.gap}`,n.value]},u)])}}),Se=[{inputs:[],name:"CLAIM_FREQUENCY",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IRewardsOnlyGauge",name:"gauge",type:"address"},{internalType:"address",name:"user",type:"address"}],name:"claimRewardsFromGauge",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IRewardsOnlyGauge[]",name:"gauges",type:"address[]"},{internalType:"address",name:"user",type:"address"}],name:"claimRewardsFromGauges",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IRewardsOnlyGauge",name:"gauge",type:"address"},{internalType:"address",name:"user",type:"address"},{internalType:"address",name:"token",type:"address"}],name:"getPendingRewards",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"}],bt=8;class ht{constructor(e=Qe,t=Se,n=z.jsonProvider,i=R){Q(this,"multicaller");this.abi=e,this.rewardsHelperAbi=t,this.provider=n,this.config=i,this.multicaller=this.resetMulticaller(e)}async decorate(e,t){this.multicaller=this.resetMulticaller(this.abi),this.callRewardTokens(e),this.callClaimableTokens(e,t);let n=await this.multicaller.execute();return M.value&&(this.multicaller=this.resetMulticaller(this.rewardsHelperAbi)),this.callClaimableRewards(e,t,n),n=await this.multicaller.execute(n),e.map(i=>({...i,...this.format(n[i.id])}))}format(e){var t;return{...e,rewardTokens:this.formatRewardTokens(e.rewardTokens),claimableTokens:((t=e.claimableTokens)==null?void 0:t.toString())||"0",claimableRewards:this.formatClaimableRewards(e.claimableRewards)}}callRewardTokens(e){e.forEach(t=>{for(let n=0;n<bt;n++)this.multicaller.call(`${t.id}.rewardTokens[${n}]`,t.id,"reward_tokens",[n])})}formatRewardTokens(e){return e.filter(t=>t!==be)}callClaimableTokens(e,t){e.forEach(n=>{this.multicaller.call(`${n.id}.claimableTokens`,n.id,"claimable_tokens",[t])})}callClaimableRewards(e,t,n){const i=M.value?"getPendingRewards":"claimable_reward";e.forEach(u=>{n[u.id].rewardTokens.forEach(d=>{if(d===be)return;const p=M.value?[u.id,t,d]:[t,d],m=M.value?R.network.addresses.gaugeRewardsHelper:u.id;this.multicaller.call(`${u.id}.claimableRewards.${d}`,m,i,p)})})}formatClaimableRewards(e){return e?(Object.keys(e).forEach(t=>{e[t]=e[t].toString()}),e):{}}resetMulticaller(e){const t=Re();return new t(this.config.network.key,this.provider,e)}}const wt=new ht;function ye(s,e={}){const{account:t,isWalletReady:n}=H(),{networkId:i}=$e(),{injectTokens:u}=ne(),d=g(()=>{var r;return(s==null?void 0:s.value)&&((r=s.value)==null?void 0:r.length)>0&&n.value}),p=P(se.Gauges.All.Onchain(s,t,i)),m=async()=>{if(!s.value)return null;const r=await wt.decorate(s.value,t.value),v=r.map(y=>y.rewardTokens).flat();return await u(v),r},o=P({enabled:d,...e});return ie(p,m,o)}const Tt={first:999},vt={id:!0,symbol:!0,poolId:!0,totalSupply:!0,isKilled:!0,factory:{id:!0},isPreferentialGauge:!0},_t=(s={},e={},t=void 0)=>({__name:t,liquidityGauges:{__args:te.merge({},Tt,s),...te.merge({},vt,e)}});class kt{constructor(e,t=_t){this.service=e,this.query=t}async get(e={},t={}){const n="Gauges",i=this.query(e,t,n);return(await this.service.client.get(i)).liquidityGauges}}class Ct{constructor(e=R.network.subgraphs.gauge){this.url=e}async get(e){try{if(!this.url)return{liquidityGauges:[]};const t=this.payloadFor(e),{data:{data:n}}=await Ue.post(this.url,t);return n}catch(t){throw console.error("GaugesSubgraphClient request failed",t),t}}payloadFor(e){return{query:He.jsonToGraphQLQuery({query:e})}}}const xt=new Ct;class Bt{constructor(e=xt){Q(this,"gauges");this.client=e,this.gauges=new kt(this)}}const Rt=new Bt;function ge(s={}){const e=P(se.Gauges.All.Static()),t=async()=>{try{return await Rt.gauges.get()}catch(i){return console.error("Failed to fetch gauges",i),[]}},n=P({enabled:!U.value,...s});return ie(e,t,n)}const $t=[{inputs:[{internalType:"contract IBalancerTokenAdmin",name:"tokenAdmin",type:"address"},{internalType:"contract IGaugeController",name:"gaugeController",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"recipient",type:"address"},{indexed:!1,internalType:"address",name:"gauge",type:"address"},{indexed:!1,internalType:"uint256",name:"minted",type:"uint256"}],name:"Minted",type:"event"},{inputs:[{internalType:"address",name:"minter",type:"address"},{internalType:"address",name:"user",type:"address"}],name:"allowed_to_mint_for",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"minter",type:"address"},{internalType:"address",name:"user",type:"address"}],name:"approvedMinter",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"getBalancerTokenAdmin",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getGaugeController",outputs:[{internalType:"contract IGaugeController",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"gauge",type:"address"}],name:"mint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"gauge",type:"address"},{internalType:"address",name:"user",type:"address"}],name:"mintFor",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address[]",name:"gauges",type:"address[]"}],name:"mintMany",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address[]",name:"gauges",type:"address[]"},{internalType:"address",name:"user",type:"address"}],name:"mintManyFor",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"gauge",type:"address"},{internalType:"address",name:"user",type:"address"}],name:"mint_for",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address[8]",name:"gauges",type:"address[8]"}],name:"mint_many",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"address",name:"gauge",type:"address"}],name:"minted",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"minter",type:"address"},{internalType:"bool",name:"approval",type:"bool"}],name:"setMinterApproval",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"minter",type:"address"}],name:"toggle_approve_mint",outputs:[],stateMutability:"nonpayable",type:"function"}];class At{constructor(e=$t,t=R,n=le,i=t.network.addresses.balancerMinter){this.abi=e,this.config=t,this.walletService=n,this.address=i}async mint(e){return await this.walletService.txBuilder.contract.sendTransaction({contractAddress:this.address,abi:this.abi,action:"mint",params:[e]})}async mintMany(e){return await this.walletService.txBuilder.contract.sendTransaction({contractAddress:this.address,abi:this.abi,action:"mintMany",params:[e]})}}const ke=new At,Ce=q({__name:"ClaimBalBtn",props:{gauges:null,label:null,amount:null},setup(s){const e=s,{t}=O(),{fNum:n}=V(),{data:i}=ge(),u=ye(i),d=g(()=>e.gauges.map(m=>oe(m.id)));async function p(){return e.gauges.length===1?await ke.mint(d.value[0]):await ke.mintMany(d.value)}return(m,o)=>(w(),C(me,{label:s.label,color:"gradient",size:"sm",actionFn:p,onConfirmFn:a(u).refetch,action:"claim",summary:`${a(t)("claim")} ${a(n)(e.amount,a(x).token)} BAL`,confirmingLabel:m.$t("claiming")},null,8,["label","onConfirmFn","summary","confirmingLabel"]))}}),Mt={class:"py-4 px-6"},Lt={class:"flex items-center py-4 px-6"},St={key:0,class:"text-left"},Dt={class:"py-4 px-6"},It={class:"flex justify-end"},Et={class:"flex justify-end"},Gt=q({__name:"BalClaimsTable",props:{rewardsData:null,isLoading:{type:Boolean}},setup(s){const e=s,{t}=O(),{upToLargeBreakpoint:n}=re(),{fNum:i}=V(),u=Ke(),{networkSlug:d}=$e(),p=ue([{name:t("pools"),id:"icons",accessor:"icons",Cell:"iconsColumnCell",width:50,noGrow:!0},{name:"",id:"pills",accessor:"pills",Cell:"pillsColumnCell",width:350},{name:t("amount"),id:"amount",align:"right",width:150,totalsCell:"totalAmountCell",accessor:({amount:y})=>`${i(y,x.token)} BAL`},{name:t("value"),id:"value",align:"right",width:150,totalsCell:"totalValueCell",accessor:({value:y})=>i(y,x.fiat)},{name:"",id:"claim",accessor:"claim",Cell:"claimColumnCell",totalsCell:"claimTotalCell",width:150}]),m=g(()=>e.rewardsData.map(y=>y.gauge)),o=g(()=>e.rewardsData.reduce((y,k)=>y.plus(k.amount),L("0")).toString()),r=g(()=>e.rewardsData.reduce((y,k)=>y.plus(k.value),L("0")).toString());function v({pool:y}){u.push({name:"pool",params:{id:y.id,networkSlug:d}})}return(y,k)=>{const $=dt,A=pe,j=ce;return w(),C(j,{shadow:"lg",square:a(n),noBorder:a(n),noPad:""},{default:b(()=>[T(A,{columns:p.value,data:s.rewardsData,noResultsLabel:y.$t("noResultsTable.noBalIncentives"),isLoading:s.isLoading,onRowClick:v,skeletonClass:"h-24",square:a(n)},{iconsColumnCell:b(({pool:B})=>[c("div",Mt,[T($,{addresses:a(We)(B),width:100},null,8,["addresses"])])]),pillsColumnCell:b(({pool:B})=>[c("div",Lt,[a(he).Metadata[B.id]?(w(),D("div",St,h(a(he).Metadata[B.id].name),1)):(w(),C(pt,{key:1,tokens:a(ze)(B,B.tokens),isStablePool:a(Ae)(B.poolType)},null,8,["tokens","isStablePool"])),T(mt,{pool:B},null,8,["pool"])])]),claimColumnCell:b(({gauge:B,amount:K})=>[c("div",Dt,[T(Ce,{label:y.$t("claim"),gauges:[B],amount:K},null,8,["label","gauges","amount"])])]),totalAmountCell:b(()=>[c("div",It,h(a(i)(a(o),a(x).token))+" BAL ",1)]),totalValueCell:b(()=>[c("div",Et,h(a(i)(a(r),a(x).fiat)),1)]),claimTotalCell:b(()=>[T(Ce,{label:y.$t("claimAll"),gauges:a(m),amount:a(o)},null,8,["label","gauges","amount"])]),_:1},8,["columns","data","noResultsLabel","isLoading","square"])]),_:1},8,["square","noBorder"])}}});class qt{constructor(e,t=z.jsonProvider,n=Se,i=le){Q(this,"instance");this.address=e,this.provider=t,this.abi=n,this.walletService=i,this.instance=new de(this.address,this.abi,this.provider)}async claimRewardsForGauge(e,t){return await this.walletService.txBuilder.contract.sendTransaction({contractAddress:this.address,abi:this.abi,action:"claimRewardsFromGauge",params:[e,t]})}}const Ft=q({__name:"ClaimRewardsBtn",props:{gauge:null,fiatValue:null},setup(s){const e=s,{t}=O(),{fNum:n}=V(),{data:i}=ge(),{account:u}=H(),d=ye(i),p=oe(e.gauge.id),m=new Ye(p);function o(){return M.value?new qt(R.network.addresses.gaugeRewardsHelper||"").claimRewardsForGauge(p,u.value):m.claimRewards()}return(r,v)=>(w(),C(me,{label:a(t)("claimAll"),color:"gradient",size:"sm",actionFn:o,onConfirmFn:a(d).refetch,action:"claim",summary:`${a(t)("claim")} ${a(n)(e.fiatValue,a(x).fiat)}`,confirmingLabel:a(t)("claiming")},null,8,["label","onConfirmFn","summary","confirmingLabel"]))}}),Pt={class:"flex items-center py-4 px-6"},Vt={class:"ml-2"},Nt={class:"flex justify-end"},Ot={class:""},jt=q({__name:"GaugeRewardsTable",props:{gauge:null,isLoading:{type:Boolean}},setup(s){const e=s,{t}=O(),{upToLargeBreakpoint:n}=re(),{fNum:i,toFiat:u}=V(),{getToken:d}=ne(),p=ue([{name:t("incentiveToken"),id:"token",accessor:"token",Cell:"tokenColumnCell",width:475,noGrow:!0},{name:t("amount"),id:"amount",align:"right",width:150,accessor:({amount:r,token:v})=>`${i(r,x.token)} ${v.symbol}`},{name:t("value"),id:"value",align:"right",width:150,totalsCell:"totalValueCell",accessor:({value:r})=>i(r,x.fiat)},{name:"",id:"claim",accessor:"claim",Cell:"claimColumnCell",totalsCell:"totalClaimCell",width:150}]),m=g(()=>e.gauge.rewardTokens.map(r=>{const v=d(r),y=N(e.gauge.claimableRewards[r],v.decimals);return{token:v,amount:y,value:u(y,v.address)}})),o=g(()=>m.value.reduce((r,v)=>r.plus(v.value),L("0")).toString());return(r,v)=>{const y=Le,k=pe,$=ce;return w(),C($,{shadow:"lg",square:a(n),noBorder:a(n),noPad:""},{default:b(()=>[T(k,{columns:p.value,data:a(m),isLoading:s.isLoading,skeletonClass:"h-64",square:a(n)},{tokenColumnCell:b(({token:A})=>[c("div",Pt,[T(y,{iconURI:A==null?void 0:A.logoURI},null,8,["iconURI"]),c("span",Vt,h(A.name),1)])]),totalValueCell:b(()=>[c("div",Nt,h(a(i)(a(o),a(x).fiat)),1)]),totalClaimCell:b(()=>[c("div",Ot,[T(Ft,{gauge:s.gauge,fiatValue:a(o)},null,8,["gauge","fiatValue"])])]),_:1},8,["columns","data","isLoading","square"])]),_:1},8,["square","noBorder"])}}}),Qt=[{inputs:[{internalType:"contract IVotingEscrow",name:"votingEscrow",type:"address"},{internalType:"uint256",name:"startTime",type:"uint256"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"contract IERC20",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"lastCheckpointTimestamp",type:"uint256"}],name:"TokenCheckpointed",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"contract IERC20",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"userTokenTimeCursor",type:"uint256"}],name:"TokensClaimed",type:"event"},{inputs:[],name:"checkpoint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IERC20",name:"token",type:"address"}],name:"checkpointToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IERC20[]",name:"tokens",type:"address[]"}],name:"checkpointTokens",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"checkpointUser",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"contract IERC20",name:"token",type:"address"}],name:"claimToken",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"contract IERC20[]",name:"tokens",type:"address[]"}],name:"claimTokens",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IERC20",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"depositToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IERC20[]",name:"tokens",type:"address[]"},{internalType:"uint256[]",name:"amounts",type:"uint256[]"}],name:"depositTokens",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getTimeCursor",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IERC20",name:"token",type:"address"}],name:"getTokenLastBalance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IERC20",name:"token",type:"address"}],name:"getTokenTimeCursor",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IERC20",name:"token",type:"address"},{internalType:"uint256",name:"timestamp",type:"uint256"}],name:"getTokensDistributedInWeek",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"timestamp",type:"uint256"}],name:"getTotalSupplyAtTimestamp",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"timestamp",type:"uint256"}],name:"getUserBalanceAtTimestamp",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getUserTimeCursor",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"contract IERC20",name:"token",type:"address"}],name:"getUserTokenTimeCursor",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getVotingEscrow",outputs:[{internalType:"contract IVotingEscrow",name:"",type:"address"}],stateMutability:"view",type:"function"}],Ut=[{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"contract IERC20[]",name:"tokens",type:"address[]"}],name:"claimTokens",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"}];class W{constructor(e,t=Qt,n=Ut,i=R,u=le,d=z.jsonProvider){Q(this,"claimableTokens",["0x7B50775383d3D6f0215A8F290f2C9e2eEBBEceb2","0xA13a9247ea42D743238089903570127DdA72fE44","0xba100000625a3754423978a60c9317c58a424e3D"]);this.address=e,this.abi=t,this.staticAbi=n,this.config=i,this.walletService=u,this.provider=d}getInstance(){return new de(this.address,this.abi,this.provider)}getMulticaller(){const e=Re();return new e(this.config.network.key,this.provider,this.abi)}async getClaimableBalances(e){const n=(await this.walletService.txBuilder.contract.callStatic({contractAddress:this.address,abi:this.staticAbi,action:"claimTokens",params:[e,this.claimableTokens]})).map(i=>i.toString());return te.zipObject(this.claimableTokens,n)}async claimBalances(e){return await this.walletService.txBuilder.contract.sendTransaction({contractAddress:this.address,abi:this.abi,action:"claimTokens",params:[e,this.claimableTokens]})}async claimBalance(e,t){return await this.walletService.txBuilder.contract.sendTransaction({contractAddress:this.address,abi:this.abi,action:"claimToken",params:[e,t]})}async getTokensDistributedInWeek(e,t,n){n||(n=this.getInstance());const i=await n.getTokensDistributedInWeek(e,t);return N(i,18)}async getTotalSupply(e,t){t||(t=this.getInstance());const n=await t.getTotalSupplyAtTimestamp(e);return N(n,18)}}const Ht=new W(R.network.addresses.feeDistributorDeprecated),Wt=new W(R.network.addresses.feeDistributor);function De(s={}){const{account:e,isWalletReady:t}=H(),n=g(()=>t.value&&e.value!=null&&!M.value&&!Me.value),i=P(se.Claims.Protocol(Xe,e)),u=async()=>{try{const[p,m]=await Promise.all([Ht.getClaimableBalances(e.value),Wt.getClaimableBalances(e.value)]);return{v1:p,v2:m}}catch(p){return console.error("Failed to fetch claimable protocol balances",p),{}}},d=P({enabled:n,...s});return ie(i,u,d)}const xe=q({__name:"ClaimProtocolRewardsBtn",props:{tokenAddress:null,fiatValue:null,deprecated:{type:Boolean}},setup(s){const e=s,t=new W(R.network.addresses.feeDistributorDeprecated),n=new W(R.network.addresses.feeDistributor),{t:i}=O(),{fNum:u}=V(),{account:d}=H(),p=De();function m(){const o=e.deprecated?t:n;return e.tokenAddress?o.claimBalance(d.value,e.tokenAddress):o.claimBalances(d.value)}return(o,r)=>(w(),C(me,Ze({label:s.tokenAddress?o.$t("claim"):o.$t("claimAll"),color:"gradient",size:"sm",actionFn:m,onConfirmFn:a(p).refetch,action:"claim",summary:`${a(i)("claim")} ${a(u)(s.fiatValue,a(x).fiat)}`,confirmingLabel:o.$t("claiming")},o.$attrs),null,16,["label","onConfirmFn","summary","confirmingLabel"]))}}),zt={key:0,class:"px-4 xl:px-0 mt-4 mb-2"},Kt={class:"text-lg"},Yt={class:"mb-3"},Xt={class:"flex justify-center ml-4 xl:ml-0"},Zt={class:"flex py-4 px-6"},Jt={class:"flex justify-end"},ea={class:"py-4 px-6"},Be=q({__name:"ProtocolRewardsTable",props:{rewardsData:null,isLoading:{type:Boolean},deprecated:{type:Boolean,default:!1}},setup(s){const e=s,{t}=O(),{upToLargeBreakpoint:n}=re(),{fNum:i}=V(),u=ue([{name:t("token"),id:"token",accessor:"token",Cell:"tokenColumnCell",align:"left",width:50,noGrow:!0},{name:"",id:"symbol",accessor:"symbol",Cell:"symbolColumnCell",width:350},{name:t("amount"),id:"amount",align:"right",width:150,accessor:({amount:o})=>`${i(o,x.token)}`},{name:t("value"),id:"value",align:"right",width:150,totalsCell:"totalValueCell",accessor:({value:o})=>i(o,x.fiat)},{name:"",id:"claim",accessor:"claim",Cell:"claimColumnCell",totalsCell:"claimTotalCell",width:150}]),d=g(()=>e.rewardsData.reduce((o,r)=>o.plus(r.amount),L("0")).toString()),p=g(()=>e.rewardsData.reduce((o,r)=>o.plus(r.value),L("0")).toString()),m=g(()=>e.isLoading?!0:L(d.value).gt(0));return(o,r)=>{const v=Le,y=pe,k=ce;return w(),D("div",null,[s.deprecated&&a(m)?(w(),D("div",zt,[c("h6",Kt,h(o.$t("pastEarnings.title")),1),c("p",Yt,h(o.$t("pastEarnings.description")),1)])):G("",!0),a(m)||!s.deprecated?(w(),C(k,{key:1,shadow:"lg",square:a(n),noBorder:a(n),noPad:"",class:"mb-8"},{default:b(()=>[T(y,{columns:u.value,data:s.rewardsData,noResultsLabel:o.$t("noResultsTable.noProtocolRevenue"),isLoading:s.isLoading,skeletonClass:"h-24",square:a(n)},{tokenColumnCell:b(({token:$})=>[c("div",Xt,[T(v,{address:$.address},null,8,["address"])])]),symbolColumnCell:b(({token:$})=>[c("div",Zt,h($.symbol),1)]),totalValueCell:b(()=>[c("div",Jt,h(a(i)(a(p),a(x).fiat)),1)]),claimColumnCell:b(({token:$,amount:A,value:j})=>[c("div",ea,[T(xe,{tokenAddress:$.address,fiatValue:j,disabled:a(L)(A).eq(0),deprecated:s.deprecated},null,8,["tokenAddress","fiatValue","disabled","deprecated"])])]),claimTotalCell:b(()=>[T(xe,{fiatValue:a(p),disabled:!a(m),deprecated:s.deprecated},null,8,["fiatValue","disabled","deprecated"])]),_:1},8,["columns","data","noResultsLabel","isLoading","square"])]),_:1},8,["square","noBorder"])):G("",!0)])}}});function ta(){const s=De(),e=g(()=>s.data.value||{}),t=ge(),n=ye(t.data),i=g(()=>n.data.value||[]),u=g(()=>i.value.map(r=>r.poolId)),d=g(()=>{var r;return(u==null?void 0:u.value)&&((r=u.value)==null?void 0:r.length)>0}),p=yt(Je.url.value,["claim","gauge","pools"],()=>({pools:{__args:{where:{id_in:u.value},first:1e3},id:!0,address:!0,poolType:!0,tokensList:!0,tokens:{address:!0,weight:!0}}}),P({enabled:d})),m=g(()=>{var r;return((r=p.data.value)==null?void 0:r.pools)||[]}),o=g(()=>_e(p)||!M.value&&!Me.value&&_e(s));return{gauges:i,gaugePools:m,protocolRewards:e,isLoading:o}}class aa{constructor(e=et,t=ae.Addresses.bbaUSD,n=z.jsonProvider){this.abi=e,this.address=t,this.provider=n}getInstance(){if(!this.address)throw new Error("No bb-a-USD address");return new de(this.address,this.abi,this.provider)}async getRate(){const t=await this.getInstance().getRate();return N(t,18)}}const na=new aa,sa={class:"xl:container py-12 xl:px-4 xl:mx-auto"},ia={class:"px-4 xl:px-0 font-body text-2xl font-semibold"},la={class:"mb-16"},oa={class:"px-4 xl:px-0"},ra={class:"flex items-center mt-6 mb-2"},ua={class:"inline-block mr-1.5 text-xl"},ca={class:"mb-16"},da={class:"inline-block xl:px-0 pl-4 mt-8 mr-1.5 mb-3 text-xl"},pa={key:1},ma={class:"inline-block px-4 xl:px-0 mt-8 mr-1.5 text-xl"},ya={class:"mb-16"},ga={class:"flex px-4 xl:px-0 mt-4"},fa={class:"mb-2 text-base"},ba={class:"px-4 xl:px-0 mb-16"},ha={class:"mt-8 font-body text-2xl font-semibold"},wa=["src","alt"],Ea=q({__name:"index",setup(s){const{injectTokens:e,injectPrices:t,getToken:n}=ne(),{balToken:i}=gt(),{toFiat:u,fNum:d}=V(),{isWalletReady:p}=H(),{gauges:m,gaugePools:o,protocolRewards:r,isLoading:v}=ta(),y=[{id:"ethereum",name:"Ethereum",key:J.MAINNET},{id:"polygon",name:"Polygon",key:J.POLYGON},{id:"arbitrum",name:"Arbitrum",key:J.ARBITRUM}],k=g(()=>v.value&&p.value&&!U.value),$=g(()=>y.filter(l=>l.key.toString()!==R.network.key)),A=g(()=>!p.value||U.value?[]:m.value.reduce((l,_)=>{const f=N(_.claimableTokens,i.value.decimals),S=o.value.find(I=>I.id===_.poolId);return S&&L(f).gt(0)&&l.push({gauge:_,pool:S,amount:f,value:u(f,i.value.address)}),l},[])),j=g(()=>fe(r.value.v2)),B=g(()=>fe(r.value.v1)),K=g(()=>m.value.filter(l=>l.rewardTokens.length>0)),Y=g(()=>K.value.reduce((l,_)=>{const f=o.value.find(I=>I.id===_.poolId),S=Object.values(_.claimableRewards).reduce((I,X)=>I.plus(X),L(0));return f&&S.gt(0)&&l.push({gauge:_,pool:f}),l},[]));async function Ie(l){const _=l.map(f=>f.rewardTokens).flat();return await e(_)}async function Ee(l){const _=l.map(f=>f.tokensList).flat();return await e(_)}function Ge(l){const _=l.tokens.map(f=>({...f,...n(oe(f.address))}));return Ae(l.poolType)?Object.values(_).map(f=>f.symbol).join(" / "):Object.values(_).map(f=>`${d(f.weight||"0",{style:"percent",maximumFractionDigits:0})} ${f.symbol}`).join(" / ")}function fe(l){return!p.value||!l||U.value?[]:Object.keys(l).map(_=>{const f=n(_),S=N(l[_],f.decimals);return{token:f,amount:S,value:u(S,_)}})}async function qe(){if(nt.value){const l=L(await na.getRate()).toNumber();t({[ae.Addresses.bbaUSD]:{[ve.usd]:l},[ae.Addresses.bbaUSDv2]:{[ve.usd]:l}})}}return we(m,async l=>{l&&await Ie(l)}),we(o,async l=>{l&&await Ee(l)}),tt(async()=>{M.value||await qe()}),(l,_)=>{const f=st,S=ut,I=rt,X=it,Fe=ft,Pe=lt,Ve=ot;return w(),D("div",null,[T(ct,{title:l.$t("claimHero.title"),description:l.$t("claimHero.description")},null,8,["title","description"]),c("div",null,[c("div",sa,[c("h2",ia,h(a(R).network.chainName)+" "+h(l.$t("liquidityIncentives")),1),a(M)?G("",!0):(w(),D(ee,{key:0},[c("div",la,[c("div",oa,[c("div",ra,[c("h3",ua," BAL "+h(l.$t("incentives")),1),T(f,{iconSize:"xs",textAlign:"left",class:"relative top-px",iconClass:"text-secondary",width:"60"},{default:b(()=>[F(h(l.$t("claimPage.tips.BalIncentives")),1)]),_:1})])]),T(Gt,{rewardsData:a(A),isLoading:a(k)},null,8,["rewardsData","isLoading"])]),c("div",ca,[c("h3",da,h(l.$t("protocolIncentives")),1),T(f,{iconSize:"xs",textAlign:"left",class:"relative top-px",iconClass:"text-secondary",width:"60"},{default:b(()=>[F(h(l.$t("claimPage.tips.ProtocolAndVebal")),1)]),_:1}),T(Be,{rewardsData:a(j),isLoading:a(k)},null,8,["rewardsData","isLoading"]),a(k)?G("",!0):(w(),C(Be,{key:0,rewardsData:a(B),isLoading:a(k),deprecated:""},null,8,["rewardsData","isLoading"]))])],64)),a(M)?G("",!0):(w(),D("div",pa,[c("h3",ma,h(l.$t("otherTokenIncentives")),1),T(f,{iconSize:"xs",textAlign:"left",class:"relative top-px",iconClass:"text-secondary",width:"60"},{default:b(()=>[F(h(l.$t("claimPage.tips.OtherIncentives")),1)]),_:1})])),a(k)?(w(),C(S,{key:2,class:"mt-6 mb-2 h-56"})):G("",!0),!a(v)&&a(Y).length>0?(w(!0),D(ee,{key:3},Te(a(Y),({gauge:E,pool:Ne})=>(w(),D("div",{key:E.id},[c("div",ya,[c("div",ga,[c("h4",fa,h(Ge(Ne)),1)]),T(jt,{gauge:E,isLoading:a(v)},null,8,["gauge","isLoading"])])]))),128)):a(U)?(w(),C(I,{key:4,class:"px-4 xl:px-0 mt-4 mb-16"},{default:b(()=>[F(h(l.$t("noClaimableIncentivesOnThisChain")),1)]),_:1})):!a(v)&&a(Y).length===0||!a(p)?(w(),C(I,{key:5,class:"px-4 xl:px-0 mt-4 mb-16"},{default:b(()=>[F(h(l.$t("noClaimableIncentives")),1)]),_:1})):G("",!0),c("div",ba,[c("h2",ha,h(l.$t("pages.claim.titles.incentivesOnOtherNetworks")),1),T(Fe,{class:"mt-4",flexWrap:""},{default:b(()=>[(w(!0),D(ee,null,Te(a($),E=>(w(),C(X,{key:E.id,tag:"a",href:`https://app.balancer.fi/${E.id}/claim`,color:"white"},{default:b(()=>[c("img",{src:a(at)(E.id),alt:E.id,class:"mr-2 w-6 h-6 rounded-full shadow-sm"},null,8,wa),F(" "+h(l.$t("pages.claim.btns.claimOn"))+" "+h(E.name),1)]),_:2},1032,["href"]))),128))]),_:1}),a(p)?(w(),C(Ve,{key:0,tag:"router-link",to:"/ethereum/claim/legacy",class:"flex items-center"},{default:b(()=>[F(h(l.$t("legacyClaims"))+" ",1),T(Pe,{name:"arrow-right",size:"sm",class:"mx-1"})]),_:1})):G("",!0)])])])])}}});export{Ea as default};
//# sourceMappingURL=index-429d9286.js.map
