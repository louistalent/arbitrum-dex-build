{"version":3,"file":"unlock-vebal-eaf9375c.js","sources":["../../src/components/forms/lock_actions/UnlockForm/components/VeBalUnlockForm/components/LockedAmount.vue","../../src/components/forms/lock_actions/UnlockForm/components/VeBalUnlockForm/VeBalUnlockForm.vue","../../src/components/forms/lock_actions/UnlockForm/UnlockForm.vue"],"sourcesContent":["<script setup lang=\"ts\">\r\nimport useNumbers, { FNumFormats } from '@/composables/useNumbers';\r\nimport { Pool } from '@/services/pool/types';\r\nimport { TokenInfo } from '@/types/TokenList';\r\n\r\n/**\r\n * TYPES\r\n */\r\ntype Props = {\r\n  lockablePool: Pool;\r\n  lockablePoolTokenInfo: TokenInfo;\r\n  totalLpTokens: string;\r\n  fiatTotalLpTokens: string;\r\n};\r\n\r\n/**\r\n * PROPS\r\n */\r\ndefineProps<Props>();\r\n\r\n/**\r\n * COMPOSABLES\r\n */\r\nconst { fNum } = useNumbers();\r\n</script>\r\n\r\n<template>\r\n  <div class=\"mb-6\">\r\n    <div class=\"pb-4\">\r\n      {{ $t('unlockVeBAL.unlockForm.lockedAmount.title') }}\r\n    </div>\r\n    <div class=\"p-3 dark:bg-gray-800 rounded-lg border dark:border-gray-800\">\r\n      <div class=\"flex items-center\">\r\n        <BalAsset :address=\"lockablePool.address\" class=\"mr-2\" :size=\"36\" />\r\n        <div class=\"w-full\">\r\n          <div class=\"flex justify-between\">\r\n            <div>{{ lockablePoolTokenInfo.symbol }}</div>\r\n            <div>{{ fNum(totalLpTokens, FNumFormats.token) }}</div>\r\n          </div>\r\n          <div class=\"flex justify-between text-gray-500\">\r\n            <div>{{ lockablePoolTokenInfo.name }}</div>\r\n            <div>{{ fNum(fiatTotalLpTokens, FNumFormats.fiat) }}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n","<script setup lang=\"ts\">\r\nimport { computed, ref } from 'vue';\r\n\r\nimport { bnum } from '@/lib/utils';\r\nimport { VeBalLockInfo } from '@/services/balancer/contracts/contracts/veBAL';\r\nimport { configService } from '@/services/config/config.service';\r\nimport { Pool } from '@/services/pool/types';\r\nimport useWeb3 from '@/services/web3/useWeb3';\r\nimport { TokenInfo } from '@/types/TokenList';\r\n\r\nimport UnlockPreviewModal from '../UnlockPreviewModal/UnlockPreviewModal.vue';\r\nimport LockedAmount from './components/LockedAmount.vue';\r\n\r\n/**\r\n * TYPES\r\n */\r\ntype Props = {\r\n  lockablePool: Pool;\r\n  lockablePoolTokenInfo: TokenInfo;\r\n  veBalLockInfo: VeBalLockInfo;\r\n};\r\n\r\n/**\r\n * PROPS\r\n */\r\nconst props = defineProps<Props>();\r\n\r\n/**\r\n * STATE\r\n */\r\nconst showPreviewModal = ref(false);\r\n\r\n/**\r\n * COMPOSABLES\r\n */\r\nconst { isWalletReady, startConnectWithInjectedProvider, isMismatchedNetwork } =\r\n  useWeb3();\r\n\r\n/**\r\n * COMPUTED\r\n */\r\nconst totalLpTokens = computed(() =>\r\n  props.veBalLockInfo?.isExpired ? props.veBalLockInfo.lockedAmount : '0'\r\n);\r\n\r\nconst fiatTotalLpTokens = computed(() =>\r\n  bnum(props.lockablePool.totalLiquidity)\r\n    .div(props.lockablePool.totalShares)\r\n    .times(totalLpTokens.value)\r\n    .toString()\r\n);\r\n\r\nconst submissionDisabled = computed(() => {\r\n  if (isMismatchedNetwork.value) {\r\n    return true;\r\n  }\r\n\r\n  return bnum(totalLpTokens.value).isZero();\r\n});\r\n</script>\r\n\r\n<template>\r\n  <BalCard shadow=\"xl\" exposeOverflow noBorder>\r\n    <template #header>\r\n      <div class=\"w-full\">\r\n        <div class=\"text-xs leading-none text-secondary\">\r\n          {{ configService.network.chainName }}\r\n        </div>\r\n        <div class=\"flex justify-between items-center\">\r\n          <h4>\r\n            {{ $t('unlockVeBAL.unlockForm.title') }}\r\n          </h4>\r\n        </div>\r\n      </div>\r\n    </template>\r\n\r\n    <LockedAmount\r\n      :lockablePool=\"lockablePool\"\r\n      :lockablePoolTokenInfo=\"lockablePoolTokenInfo\"\r\n      :totalLpTokens=\"totalLpTokens\"\r\n      :fiatTotalLpTokens=\"fiatTotalLpTokens\"\r\n    />\r\n\r\n    <div class=\"mt-6\">\r\n      <BalBtn\r\n        v-if=\"!isWalletReady\"\r\n        :label=\"$t('connectWallet')\"\r\n        color=\"gradient\"\r\n        block\r\n        @click=\"startConnectWithInjectedProvider\"\r\n      />\r\n      <BalBtn\r\n        v-else\r\n        color=\"gradient\"\r\n        block\r\n        :disabled=\"submissionDisabled\"\r\n        @click=\"showPreviewModal = true\"\r\n      >\r\n        {{ $t('preview') }}\r\n      </BalBtn>\r\n    </div>\r\n  </BalCard>\r\n  <teleport to=\"#modal\">\r\n    <UnlockPreviewModal\r\n      v-if=\"showPreviewModal\"\r\n      :lockablePool=\"lockablePool\"\r\n      :lockablePoolTokenInfo=\"lockablePoolTokenInfo\"\r\n      :veBalLockInfo=\"veBalLockInfo\"\r\n      :totalLpTokens=\"totalLpTokens\"\r\n      :fiatTotalLpTokens=\"fiatTotalLpTokens\"\r\n      @close=\"showPreviewModal = false\"\r\n    />\r\n  </teleport>\r\n</template>\r\n","<script setup lang=\"ts\">\r\nimport { computed } from 'vue';\r\n\r\nimport Col3Layout from '@/components/layouts/Col3Layout.vue';\r\nimport usePoolQuery from '@/composables/queries/usePoolQuery';\r\nimport useVeBalLockInfoQuery from '@/composables/queries/useVeBalLockInfoQuery';\r\nimport { useTokens } from '@/providers/tokens.provider';\r\nimport useVeBal from '@/composables/useVeBAL';\r\nimport { Pool } from '@/services/pool/types';\r\nimport useWeb3 from '@/services/web3/useWeb3';\r\n\r\nimport MyVeBAL from '../LockForm/components/MyVeBAL.vue';\r\nimport VeBalUnlockForm from './components/VeBalUnlockForm/VeBalUnlockForm.vue';\r\n\r\n/**\r\n * COMPOSABLES\r\n */\r\nconst { getToken } = useTokens();\r\nconst { isWalletReady } = useWeb3();\r\nconst { lockablePoolId } = useVeBal();\r\n\r\n/**\r\n * QUERIES\r\n */\r\nconst lockablePoolQuery = usePoolQuery(lockablePoolId.value as string);\r\nconst veBalLockInfoQuery = useVeBalLockInfoQuery();\r\n\r\n/**\r\n * COMPUTED\r\n */\r\nconst lockablePoolLoading = computed(() => lockablePoolQuery.isLoading.value);\r\n\r\nconst veBalQueryLoading = computed(() => veBalLockInfoQuery.isLoading.value);\r\n\r\nconst lockablePool = computed<Pool | undefined>(\r\n  () => lockablePoolQuery.data.value\r\n);\r\n\r\nconst lockablePoolTokenInfo = computed(() =>\r\n  lockablePool.value != null ? getToken(lockablePool.value.address) : null\r\n);\r\n\r\nconst veBalLockInfo = computed(() => veBalLockInfoQuery.data.value);\r\n\r\nconst isLoading = computed(() =>\r\n  isWalletReady.value\r\n    ? lockablePoolLoading.value || veBalQueryLoading.value\r\n    : lockablePoolLoading.value\r\n);\r\n</script>\r\n\r\n<template>\r\n  <Col3Layout offsetGutters>\r\n    <BalLoadingBlock\r\n      v-if=\"\r\n        isLoading || !veBalLockInfo || !lockablePool || !lockablePoolTokenInfo\r\n      \"\r\n      class=\"h-96\"\r\n    />\r\n    <VeBalUnlockForm\r\n      v-else\r\n      :key=\"\r\n        veBalLockInfo?.hasExistingLock\r\n          ? 'veBalUnlockForm-hasLock'\r\n          : 'veBalUnlockForm-noLock'\r\n      \"\r\n      :lockablePool=\"lockablePool\"\r\n      :lockablePoolTokenInfo=\"lockablePoolTokenInfo\"\r\n      :veBalLockInfo=\"veBalLockInfo\"\r\n    />\r\n\r\n    <template #gutterRight>\r\n      <BalLoadingBlock v-if=\"isLoading\" class=\"h-64\" />\r\n      <MyVeBAL v-else :veBalLockInfo=\"veBalLockInfo\" />\r\n    </template>\r\n  </Col3Layout>\r\n</template>\r\n"],"names":["fNum","useNumbers","showPreviewModal","ref","isWalletReady","startConnectWithInjectedProvider","isMismatchedNetwork","useWeb3","totalLpTokens","computed","_a","props","fiatTotalLpTokens","bnum","submissionDisabled","getToken","useTokens","lockablePoolId","useVeBal","lockablePoolQuery","usePoolQuery","veBalLockInfoQuery","useVeBalLockInfoQuery","lockablePoolLoading","veBalQueryLoading","lockablePool","lockablePoolTokenInfo","veBalLockInfo","isLoading"],"mappings":"mqCAuBA,KAAA,CAAA,KAAAA,GAAAC,utBCOAC,EAAAC,EAAA,EAAA,EAKA,CAAA,cAAAC,EAAA,iCAAAC,EAAA,oBAAAC,CAAA,EAAAC,EAAA,EAMAC,EAAAC,EAAsB,IAAA,OAAA,OAAAC,EAAAC,EAAA,gBAAA,MAAAD,EAAA,UAAAC,EAAA,cAAA,aAAA,IACgD,EAGtEC,EAAAH,EAA0B,IAAAI,EAAAF,EAAA,aAAA,cAAA,EAAA,IAAAA,EAAA,aAAA,WAAA,EAAA,MAAAH,EAAA,KAAA,EAAA,SAAA,CAIZ,EAGdM,EAAAL,EAAA,IACEH,EAAA,MACE,GAGFO,EAAAL,EAAA,KAAA,EAAA,OAAA,CAAwC,0nCCxC1C,KAAA,CAAA,SAAAO,GAAAC,IACA,CAAA,cAAAZ,GAAAG,IACA,CAAA,eAAAU,GAAAC,IAKAC,EAAAC,EAAAH,EAAA,KAAA,EACAI,EAAAC,IAKAC,EAAAd,EAAA,IAAAU,EAAA,UAAA,KAAA,EAEAK,EAAAf,EAAA,IAAAY,EAAA,UAAA,KAAA,EAEAI,EAAAhB,EAAqB,IAAAU,EAAA,KAAA,KACU,EAG/BO,EAAAjB,EAA8B,IAAAgB,EAAA,OAAA,KAAAV,EAAAU,EAAA,MAAA,OAAA,EAAA,IACwC,EAGtEE,EAAAlB,EAAA,IAAAY,EAAA,KAAA,KAAA,EAEAO,EAAAnB,EAAkB,IAAAL,EAAA,MAAAmB,EAAA,OAAAC,EAAA,MAAAD,EAAA,KAGQ"}